using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using DesktopClock.Core.Models;

namespace DesktopClock.Tests.xUnit;

public class DateTimeRangeTests
{
    public static IEnumerable<object[]> TestData()
    {
        //                          Arrange Params                                                                                                              Expected Result
        //                          startDateTime1          finishDateTime1         iS1    iF1    startDateTime2          finishDateTime2         iS2    iF2    Includes Overlaps GetIntersecton / GetUnion / ExcludeOverlaps
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:02Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:02Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  false) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:04Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:04Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:04Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:05Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:05Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:04Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:07Z", "2000-01-01T00:00:07Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:07Z", "2000-01-01T00:00:07Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:07Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:07Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:07Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:07Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, true,    false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) } };

        // ================================

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:02Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:02Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:02Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:05Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] {  } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:05Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) }, new DateTimeRange[] {  } };


        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] {  } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:04Z", false, false, true,    false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:04Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:04Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:05Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:05Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ), new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:05Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:05Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:05Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, false, true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:04Z", "2000-01-01T00:00:06Z", false, true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:04Z", "2000-01-01T00:00:08Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:04Z", "2000-01-01T00:00:08Z", true,  true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:04Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  false), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:04Z"), false, false) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:06Z", "2000-01-01T00:00:06Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", true,  false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, true,  "2000-01-01T00:00:06Z", "2000-01-01T00:00:08Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:06Z"), DateTime.Parse("2000-01-01T00:00:06Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:07Z", "2000-01-01T00:00:07Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:07Z", "2000-01-01T00:00:07Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:07Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:07Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:06Z", false, false, "2000-01-01T00:00:07Z", "2000-01-01T00:00:08Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false), new(DateTime.Parse("2000-01-01T00:00:07Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:06Z"), false, false) } };

        // --------
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:01Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:01Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:03Z", false, true,  false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:03Z"), false, true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:01Z", "2000-01-01T00:00:08Z", false, false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:01Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  true,    true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), false, false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:03Z", "2000-01-01T00:00:08Z", true,  false, false,   true,    new DateTimeRange(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  false) }, new DateTimeRange[] {  } };

        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] {  }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", false, false, false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", false, false, "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] {  } };
        yield return new object[] { "2000-01-01T00:00:03Z", "2000-01-01T00:00:03Z", true,  true,  "2000-01-01T00:00:08Z", "2000-01-01T00:00:08Z", true,  true,  false,   false,   DateTimeRange.Empty, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ), new(DateTime.Parse("2000-01-01T00:00:08Z"), DateTime.Parse("2000-01-01T00:00:08Z"), true,  true ) }, new DateTimeRange[] { new(DateTime.Parse("2000-01-01T00:00:03Z"), DateTime.Parse("2000-01-01T00:00:03Z"), true,  true ) } };
    }

    [Theory]
    [MemberData(nameof(TestData))]
    public void Includes_WhenPassedARange_ReturnsExpectedResult(
            string startDateTime1, string finishDateTime1, bool includesStart1, bool includesFinish1,
            string startDateTime2, string finishDateTime2, bool includesStart2, bool includesFinish2,
            bool expected, object _1, object _2, object _3, object _4)
    {
        // arrange
        var range1 = new DateTimeRange(DateTime.Parse(startDateTime1), DateTime.Parse(finishDateTime1), includesStart1, includesFinish1);
        var range2 = new DateTimeRange(DateTime.Parse(startDateTime2), DateTime.Parse(finishDateTime2), includesStart2, includesFinish2);

        // act
        var actual = range1.Includes(range2);

        // assert
        Assert.Equal(expected, actual);
    }

    [Theory]
    [MemberData(nameof(TestData))]
    public void Overlaps_WhenPassedARange_ReturnsExpectedResult(
            string startDateTime1, string finishDateTime1, bool includesStart1, bool includesFinish1,
            string startDateTime2, string finishDateTime2, bool includesStart2, bool includesFinish2,
            object _0, bool expected, object _2, object _3, object _4)
    {
        // arrange
        var range1 = new DateTimeRange(DateTime.Parse(startDateTime1), DateTime.Parse(finishDateTime1), includesStart1, includesFinish1);
        var range2 = new DateTimeRange(DateTime.Parse(startDateTime2), DateTime.Parse(finishDateTime2), includesStart2, includesFinish2);

        // act
        var actual = range1.Overlaps(range2);

        // assert
        Assert.Equal(expected, actual);
    }

    [Theory]
    [MemberData(nameof(TestData))]
    public void GetIntersection_WhenPassedARange_ReturnsExpectedResult(
            string startDateTime1, string finishDateTime1, bool includesStart1, bool includesFinish1,
            string startDateTime2, string finishDateTime2, bool includesStart2, bool includesFinish2,
            object _0, object _1, DateTimeRange expected, object _3, object _4)
    {
        // arrange
        var range1 = new DateTimeRange(DateTime.Parse(startDateTime1), DateTime.Parse(finishDateTime1), includesStart1, includesFinish1);
        var range2 = new DateTimeRange(DateTime.Parse(startDateTime2), DateTime.Parse(finishDateTime2), includesStart2, includesFinish2);

        // act
        var actual = range1.GetIntersection(range2);

        // assert
        Assert.Equal(expected, actual);
    }

    [Theory]
    [MemberData(nameof(TestData))]
    public void GetUnion_WhenPassedARange_ReturnsExpectedResult(
            string startDateTime1, string finishDateTime1, bool includesStart1, bool includesFinish1,
            string startDateTime2, string finishDateTime2, bool includesStart2, bool includesFinish2,
            object _0, object _1, object _2, IList<DateTimeRange> expected, object _4)
    {
        // arrange
        var range1 = new DateTimeRange(DateTime.Parse(startDateTime1), DateTime.Parse(finishDateTime1), includesStart1, includesFinish1);
        var range2 = new DateTimeRange(DateTime.Parse(startDateTime2), DateTime.Parse(finishDateTime2), includesStart2, includesFinish2);

        // act
        var actual = range1.GetUnion(range2);

        // assert
        Assert.Equal(expected, actual);
    }

    [Theory]
    [MemberData(nameof(TestData))]
    public void ExcludeOverlap_WhenPassedARange_ReturnsExpectedResult(
            string startDateTime1, string finishDateTime1, bool includesStart1, bool includesFinish1,
            string startDateTime2, string finishDateTime2, bool includesStart2, bool includesFinish2,
            object _0, object _1, object _2, object _3, IList<DateTimeRange> expected)
    {
        // arrange
        var range1 = new DateTimeRange(DateTime.Parse(startDateTime1), DateTime.Parse(finishDateTime1), includesStart1, includesFinish1);
        var range2 = new DateTimeRange(DateTime.Parse(startDateTime2), DateTime.Parse(finishDateTime2), includesStart2, includesFinish2);

        // act
        var actual = range1.ExcludeOverlap(range2);

        // assert
        Assert.Equal(expected, actual);
    }
}
